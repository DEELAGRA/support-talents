package main

import (
	"fmt"
	"strings"
)

// –§—É–Ω–∫—Ü–∏—è quicksort —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º ‚Äî —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–ª–∞–π—Å
func quicksort(slice []int, low, high int, depth int) {
	// –û—Ç—Å—Ç—É–ø –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ (—á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ä–µ–∫—É—Ä—Å–∏–∏)
	indent := strings.Repeat("  ", depth)

	// –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π: –µ—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω –ø—É—Å—Ç –∏–ª–∏ –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ ‚Äî –≤—ã—Ö–æ–¥–∏–º
	if low >= high {
		fmt.Printf("%s[–ë–ê–ó–ê] low=%d, high=%d ‚Üí –≤—ã—Ö–æ–¥ (–Ω–µ—á–µ–≥–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å)\n", indent, low, high)
		return
	}

	// –í—ã–≤–æ–¥–∏–º —Ç–µ–∫—É—â–∏–π —É—á–∞—Å—Ç–æ–∫ –º–∞—Å—Å–∏–≤–∞ –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º
	fmt.Printf("%s[–í–•–û–î]  slice[%d:%d] = %v\n", indent, low, high, slice[low:high+1])

	// –í—ã–ø–æ–ª–Ω—è–µ–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å pivot
	pivotIndex := partition(slice, low, high, depth)

	// –ü–æ—Å–ª–µ partition –≤–µ—Å—å —Å–ª–∞–π—Å –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Äî –ø–æ–∫–∞–∂–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	fmt.Printf("%s[–†–ê–ó–î–ï–õ–ï–ù–û] pivot=%d –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ %d\n", indent, slice[pivotIndex], pivotIndex)

	// –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ª–µ–≤—É—é —á–∞—Å—Ç—å (–¥–æ pivot)
	fmt.Printf("%s‚Üí –°–æ—Ä—Ç–∏—Ä—É–µ–º –ª–µ–≤—É—é —á–∞—Å—Ç—å [%d : %d]\n", indent, low, pivotIndex-1)
	quicksort(slice, low, pivotIndex-1, depth+1)

	// –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø—Ä–∞–≤—É—é —á–∞—Å—Ç—å (–ø–æ—Å–ª–µ pivot)
	fmt.Printf("%s‚Üí –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø—Ä–∞–≤—É—é —á–∞—Å—Ç—å [%d : %d]\n", indent, pivotIndex+1, high)
	quicksort(slice, pivotIndex+1, high, depth+1)

	// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —ç—Ç–∞ –≤–µ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
	fmt.Printf("%s[–ì–û–¢–û–í–û] slice[%d:%d] –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ\n", indent, low, high)
}

// –§—É–Ω–∫—Ü–∏—è partition —Ä–∞–∑–¥–µ–ª—è–µ—Ç —Å–ª–∞–π—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ pivot
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–∞ —É–∫–∞–∑–∞—Ç–µ–ª—è: i –∏ j
func partition(slice []int, low, high int, depth int) int {
	// –û—Ç—Å—Ç—É–ø –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
	indent := strings.Repeat("  ", depth)

	// –í—ã–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –∫–∞–∫ –æ–ø–æ—Ä–Ω—ã–π
	pivot := slice[high]
	fmt.Printf("%s  –í—ã–±—Ä–∞–Ω pivot = %d (slice[%d])\n", indent, pivot, high)

	// –£–∫–∞–∑–∞—Ç–µ–ª—å i ‚Äî –≥—Ä–∞–Ω–∏—Ü–∞ –º–µ–∂–¥—É "‚â§ pivot" –∏ "> pivot"
	// –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —É—á–∞—Å—Ç–∫–∞
	i := low - 1
	fmt.Printf("%s  i = %d (–≥—Ä–∞–Ω–∏—Ü–∞ '—Ö–æ—Ä–æ—à–∏—Ö' —ç–ª–µ–º–µ–Ω—Ç–æ–≤)\n", indent, i)

	// –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º –æ—Ç low –¥–æ high-1
	for j := low; j < high; j++ {
		fmt.Printf("%s  j=%d, slice[j]=%d ‚Üí —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å pivot=%d", indent, j, slice[j], pivot)

		if slice[j] <= pivot {
			// –≠–ª–µ–º–µ–Ω—Ç ‚â§ pivot ‚Äî –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –ª–µ–≤—É—é —á–∞—Å—Ç—å
			i++
			fmt.Printf(" ‚Üí slice[j] <= pivot ‚Üí i —É–≤–µ–ª–∏—á–µ–Ω –¥–æ %d", i)

			// –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ slice[i] –∏ slice[j]
			if i != j {
				fmt.Printf(" ‚Üí –º–µ–Ω—è–µ–º slice[%d]=%d –∏ slice[%d]=%d", i, slice[i], j, slice[j])
				slice[i], slice[j] = slice[j], slice[i]
			} else {
				fmt.Printf(" ‚Üí i == j, –æ–±–º–µ–Ω –Ω–µ –Ω—É–∂–µ–Ω")
			}
		} else {
			fmt.Printf(" ‚Üí slice[j] > pivot ‚Üí j++, i –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è")
		}
		fmt.Printf("\n")
	}

	// –ü–æ—Å–ª–µ —Ü–∏–∫–ª–∞ —Å—Ç–∞–≤–∏–º pivot –Ω–∞ —Å–≤–æ—ë –º–µ—Å—Ç–æ: –º–µ–Ω—è–µ–º slice[i+1] –∏ slice[high]
	i++
	fmt.Printf("%s  –í—Å–µ ‚â§ pivot –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã. –°—Ç–∞–≤–∏–º pivot –Ω–∞ –º–µ—Å—Ç–æ %d\n", indent, i)
	fmt.Printf("%s  –ú–µ–Ω—è–µ–º slice[%d]=%d —Å slice[%d]=%d\n", indent, i, slice[i], high, slice[high])
	slice[i], slice[high] = slice[high], slice[i]

	// –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å pivot
	return i
}

// –£–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–∑–æ–≤–∞ –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –≥—Ä–∞–Ω–∏—Ü
func QuickSort(slice []int) {
	fmt.Println("üöÄ –ó–∞–ø—É—Å–∫ –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏...")
	if len(slice) > 1 {
		quicksort(slice, 0, len(slice)-1, 0)
	} else {
		fmt.Println("–ú–∞—Å—Å–∏–≤ –ø—É—Å—Ç –∏–ª–∏ –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ ‚Üí —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞")
	}
	fmt.Println("‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
func main() {
	data := []int{64, 34, 25, 12, 22, 11, 90}

	fmt.Printf("üìã –ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: %v\n\n", data)

	QuickSort(data)

	fmt.Printf("\nüéâ –†–µ–∑—É–ª—å—Ç–∞—Ç: %v\n", data)
}
